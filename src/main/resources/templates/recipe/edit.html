<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org/">
<head th:replace="fragments :: head"></head>
<body>

<div th:replace="fragments :: navigation"></div>

<div class="pageContent">
    <form method="post" th:object="${recipe}">
    <!--    BASE RECIPE INFO-->
    <fieldset class="inputDiv">
        <h3>Recipe Details</h3>
        <label>Name</label>
        <input th:field="*{name}"/>
        <span th:errors="*{name}"></span>

        <label>Description</label>
        <input th:field="*{description}"/>
        <span th:errors="*{description}"></span>

    </fieldset>

    <!--    CATEGORIES-->
    <fieldset class="inputDiv">
        <h3>Categories</h3>
        <label>Select Categories</label>
            <th:block th:each="category : ${categories}">
                <input type="checkbox"
                       th:value="${category.id}"
                       th:field="*{categories}"/>
                <label th:text="${category.name}"></label>
            </th:block>
        <span th:errors="*{categories}"></span>
    </fieldset>

    <!--    INGREDIENTS-->
    <fieldset class="inputDiv">
        <h3>Ingredients</h3>
        <label>Ingredient</label>
        <th:block th:field="*{ingredients}" th:each="ingredient, ing : *{ingredients}">
            <input hidden th:name="ingredientIds" th:value="${ingredient.id}"/> <!--"|ingredients[${ing.index}].id|"-->
            <input th:name="|ingredients[${ing.index}].name|" th:value="${ingredient.name}"/>

            <input th:name="|ingredients[${ing.index}].amount|" th:value="${ingredient.amount}"/>

            <select th:name="|ingredients[${ing.index}].unit|">
                <option th:each="unit : ${units}"
                        th:text="${unit.abbreviation}"
                        th:value="${unit.id}"
                        th:selected="${unit.id == ingredient.unit.id}"/>
            </select>
            <button id="addIngredient" th:type="button" th:onclick="addAnotherIngredient()">Add Another Ingredient</button>
        </th:block>
    </fieldset>

    <!--    DIRECTIONS-->
    <fieldset class="inputDiv">
        <h3>Directions</h3>
        <label>Directions</label>
        <button class="actionButton"
                id="addDirection"
                name="addDirection"
                type="button"
                onclick="addAnotherDirection()">Add Another Step</button>
        <ol id="directionFieldString">
            <li th:each="direction, dir : *{directions}">
                <input hidden th:value="${direction.id}" th:name="directionIds"/>
                <input type="text"
                       th:name="|directions[${dir.index}].instruction|"
                       th:value="${direction.instruction}"/>
            </li>
        </ol>
    </fieldset>

    <input type="hidden" th:value="*{id}" name="recipeId"/>

    <input type="submit" value="Save Changes" name="Save"/>
    <a class="editDeleteLinks" th:href="@{/recipe/browse}">Cancel</a>
    <input type="submit" value="Delete Recipe" name="Delete"/>

    </form>
</div>

</body>
</html>